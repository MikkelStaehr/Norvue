{{ 'section-testimonials-norvue.css' | asset_url | stylesheet_tag }}

<div class="testimonials-norvue color-{{ section.settings.color_scheme }}">
  <div class="testimonials-norvue__wrapper page-width">
    {%- if section.settings.heading != blank -%}
      <h2 class="testimonials-norvue__heading{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}">
        {{ section.settings.heading }}
      </h2>
    {%- endif -%}

    {%- if section.settings.subheading != blank -%}
      <div class="testimonials-norvue__subheading rte{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}">
        {{ section.settings.subheading }}
      </div>
    {%- endif -%}

    <div class="testimonials-norvue__grid">
      {%- for block in section.blocks -%}
        <div
          class="testimonials-norvue__item{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}"
          {% if settings.animations_reveal_on_scroll %}
            data-cascade
            style="--animation-order: {{ forloop.index }};"
          {% endif %}
          {{ block.shopify_attributes }}
        >
          <div class="testimonials-norvue__content">
            {%- if block.settings.quote != blank -%}
              <div class="testimonials-norvue__quote">
                <svg
                  class="testimonials-norvue__quote-icon"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path d="M10 11L8 17H5L7 11H5V5H11V11H10ZM18 11L16 17H13L15 11H13V5H19V11H18Z" fill="currentColor"/>
                </svg>
                <div class="testimonials-norvue__quote-text rte">
                  {{ block.settings.quote }}
                </div>
              </div>
            {%- endif -%}

            <div class="testimonials-norvue__author">
              {%- if block.settings.author_image != blank -%}
                <div class="testimonials-norvue__author-image">
                  <img
                    srcset="{{ block.settings.author_image | image_url: width: 100 }}"
                    src="{{ block.settings.author_image | image_url: width: 100 }}"
                    alt="{{ block.settings.author_name | escape }}"
                    width="{{ block.settings.author_image.width }}"
                    height="{{ block.settings.author_image.height }}"
                    loading="lazy"
                  >
                </div>
              {%- endif -%}

              <div class="testimonials-norvue__author-info">
                {%- if block.settings.author_name != blank -%}
                  <p class="testimonials-norvue__author-name">{{ block.settings.author_name }}</p>
                {%- endif -%}

                {%- if block.settings.author_info != blank -%}
                  <p class="testimonials-norvue__author-title">{{ block.settings.author_info }}</p>
                {%- endif -%}
              </div>
            </div>
          </div>
        </div>
      {%- endfor -%}
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    // IntersectionObserver til animation
    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            // Tilføj klasse, når elementet er synligt
            entry.target.classList.add('animate-active');
            observer.unobserve(entry.target);
          }
        });
      },
      {
        threshold: 0.1,
      }
    );

    // Observer alle elementer med animate--slide-in klassen
    document.querySelectorAll('.animate--slide-in').forEach((el) => {
      observer.observe(el);
    });
  });
</script>

{% schema %}
{
  "name": "Kundeudtalelser",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "default": "Kunderne siger",
      "label": "Overskrift"
    },
    {
      "type": "richtext",
      "id": "subheading",
      "default": "<p>Læs hvad vores tilfredse kunder siger om vores produkter</p>",
      "label": "Undertekst"
    },
    {
      "type": "select",
      "id": "layout",
      "options": [
        {
          "value": "grid",
          "label": "Grid"
        },
        {
          "value": "grid--3-column",
          "label": "3 kolonner"
        }
      ],
      "default": "grid",
      "label": "Layout"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Farveskema",
      "default": "background-2"
    },
    {
      "type": "header",
      "content": "Sektions-mellemrum"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Top mellemrum",
      "default": 40
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Bund mellemrum",
      "default": 40
    }
  ],
  "blocks": [
    {
      "type": "testimonial",
      "name": "Udtalelse",
      "settings": [
        {
          "type": "richtext",
          "id": "quote",
          "default": "<p>Del en anmeldelse eller kundeudtalelse for at vise troværdighed og social proof for dine produkter.</p>",
          "label": "Udtalelse"
        },
        {
          "type": "text",
          "id": "author_name",
          "default": "Kunde Navn",
          "label": "Forfatter navn"
        },
        {
          "type": "text",
          "id": "author_info",
          "default": "Tilfreds kunde",
          "label": "Forfatter info"
        },
        {
          "type": "image_picker",
          "id": "author_image",
          "label": "Forfatter billede"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Kundeudtalelser",
      "category": "Testimonials",
      "blocks": [
        {
          "type": "testimonial"
        },
        {
          "type": "testimonial"
        },
        {
          "type": "testimonial"
        }
      ]
    }
  ]
}
{% endschema %}

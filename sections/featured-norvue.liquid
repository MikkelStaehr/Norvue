{{ 'section-featured-norvue.css' | asset_url | stylesheet_tag }}

<div class="featured-norvue">
  <div class="featured-norvue__wrapper page-width">
    <div class="featured-norvue__grid">
      {%- if section.settings.collection != blank -%}
        {%- assign products_to_display = section.settings.products_to_show -%}

        {%- for product in section.settings.collection.products limit: products_to_display -%}
          <div
            class="featured-norvue__product{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}"
            {% if settings.animations_reveal_on_scroll %}
              data-cascade
              style="--animation-order: {{ forloop.index }};"
            {% endif %}
          >
            <a href="{{ product.url }}" class="featured-norvue__product-link">
              <div class="featured-norvue__product-image-wrapper">
                {%- if product.featured_media != blank -%}
                  <img
                    srcset="
                      {%- if product.featured_media.width >= 165 -%}{{ product.featured_media | image_url: width: 165 }} 165w,{%- endif -%}
                      {%- if product.featured_media.width >= 360 -%}{{ product.featured_media | image_url: width: 360 }} 360w,{%- endif -%}
                      {%- if product.featured_media.width >= 533 -%}{{ product.featured_media | image_url: width: 533 }} 533w,{%- endif -%}
                      {%- if product.featured_media.width >= 720 -%}{{ product.featured_media | image_url: width: 720 }} 720w,{%- endif -%}
                      {%- if product.featured_media.width >= 940 -%}{{ product.featured_media | image_url: width: 940 }} 940w,{%- endif -%}
                      {{ product.featured_media | image_url }} {{ product.featured_media.width }}w
                    "
                    src="{{ product.featured_media | image_url: width: 533 }}"
                    sizes="(min-width: 1400px) 317px, (min-width: 990px) calc((100vw - 130px) / 4), (min-width: 750px) calc((100vw - 120px) / 3), calc((100vw - 35px) / 2)"
                    alt="{{ product.featured_media.alt | escape }}"
                    class="featured-norvue__product-image"
                    loading="lazy"
                    width="{{ product.featured_media.width }}"
                    height="{{ product.featured_media.height }}"
                  >
                {%- else -%}
                  {{ 'product-apparel-1' | placeholder_svg_tag: 'placeholder-svg' }}
                {%- endif -%}

                {%- if product.available == false -%}
                  <div class="featured-norvue__product-badge">
                    <span>{{ 'products.product.sold_out' | t }}</span>
                  </div>
                {%- elsif product.compare_at_price > product.price and product.available -%}
                  <div class="featured-norvue__product-badge">
                    <span>{{ 'products.product.on_sale' | t }}</span>
                  </div>
                {%- endif -%}
              </div>

              <div class="featured-norvue__product-info">
                <h3 class="featured-norvue__product-title">
                  {{ product.title }}
                </h3>

                {%- if section.settings.show_vendor -%}
                  <p class="featured-norvue__product-vendor">{{ product.vendor }}</p>
                {%- endif -%}

                <div class="featured-norvue__product-price">
                  {%- if product.compare_at_price > product.price -%}
                    <span class="featured-norvue__product-price-item price-item--sale">
                      {{ product.price | money }}
                    </span>
                    <span class="featured-norvue__product-price-item price-item--regular">
                      {{ product.compare_at_price | money }}
                    </span>
                  {%- else -%}
                    <span class="featured-norvue__product-price-item">
                      {{ product.price | money }}
                    </span>
                  {%- endif -%}
                </div>
              </div>
            </a>
          </div>
        {%- endfor -%}
      {%- endif -%}
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Norvue Featured",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "collection",
      "id": "collection",
      "label": "Kollektion"
    },
    {
      "type": "range",
      "id": "products_to_show",
      "min": 2,
      "max": 4,
      "step": 1,
      "default": 3,
      "label": "Antal produkter at vise"
    },
    {
      "type": "checkbox",
      "id": "show_vendor",
      "default": false,
      "label": "Vis leverandør"
    },
    {
      "type": "header",
      "content": "Sektions mellemrum"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Øverste mellemrum",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Nederste mellemrum",
      "default": 36
    }
  ],
  "presets": [
    {
      "name": "Norvue Featured",
      "category": "Produkter",
      "settings": {
        "products_to_show": 3,
        "show_vendor": false
      }
    }
  ]
}
{% endschema %}
